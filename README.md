# AI-Guided Practice for Colors - Usage Guide

This guide provides an overview of how to use the backend API for the AI-guided color practice experience. The API is designed to facilitate a back-and-forth interaction between the user and the AI, helping users learn and practice Makaton signs for different colors.

## Table of Contents
1. [Start the Practice Session](#1-start-the-practice-session)
2. [User Response (Voice)](#2-user-response-voice)
3. [Process User Response](#3-process-user-response)
4. [Request Help](#4-request-help)
5. [Retry Prompt](#5-retry-prompt)
6. [User Successfully Signs the Color](#6-user-successfully-signs-the-color)
7. [Serve Audio File](#7-serve-audio-file)

### 1. Start the Practice Session
The practice session starts with the AI asking the user if they would like to practice colors.

```sh
curl -X POST http://localhost:5001/start -H "Content-Type: application/json" -d '{}'
```
- **Expected Response**: 
  ```json
  {
    "audioUrl": "/audio/<filename>",
    "prompt": "Would you like to practice colors today?"
  }
  ```
  - **audioUrl**: URL to the generated audio file.
  - **prompt**: Text version of the prompt.

### 2. User Response (Voice)
The user speaks their response, such as "Yes," and uploads the recorded audio file.

```sh
curl -X POST http://localhost:5001/transcribe-audio -F "file=@path/to/your/audio-file.mp3"
```
- **Expected Response**: 
  ```json
  {
    "transcribedText": "yes"
  }
  ```
  - **transcribedText**: Text transcription of the user's audio response.

### 3. Process User Response
Use the transcribed text (e.g., "yes") to progress the session.

```sh
curl -X POST http://localhost:5001/user-response -H "Content-Type: application/json" -d '{"response": "yes"}'
```
- **Expected Response**: 
  ```json
  {
    "audioUrl": "/audio/<filename>",
    "prompt": "Great! Let's start with the color [random color]. Can you show me the sign for [color]?"
  }
  ```
  - **audioUrl**: URL to the generated audio file.
  - **prompt**: Text version of the prompt.

### 4. Request Help (Optional)
If the user struggles and needs help:

1. User records their request for help, such as "I need help," and uploads it.

   ```sh
   curl -X POST http://localhost:5001/transcribe-audio -F "file=@path/to/your/audio-file.mp3"
   ```
   - **Expected Response**: 
     ```json
     {
       "transcribedText": "i need help"
     }
     ```
     - **transcribedText**: Text transcription of the user's audio response.

2. Send this response to the `/user-response` endpoint.

   ```sh
   curl -X POST http://localhost:5001/user-response -H "Content-Type: application/json" -d '{"response": "i need help"}'
   ```

3. Request help from the AI using the `/help` endpoint.

   ```sh
   curl -X POST http://localhost:5001/help -H "Content-Type: application/json" -d '{}'
   ```
   - **Expected Response**: 
     ```json
     {
       "audioUrl": "/audio/<filename>",
       "prompt": "No worries! Here's a hint. Watch the video showing the sign for [color].",
       "hintVideoUrl": "/videos/<color>.mp4"
     }
     ```
     - **audioUrl**: URL to the generated audio file.
     - **prompt**: Text version of the prompt.
     - **hintVideoUrl**: URL to the hint video for the current color.

### 5. Retry Prompt
The AI encourages the user to try again after providing help.

```sh
curl -X POST http://localhost:5001/retry -H "Content-Type: application/json" -d '{}'
```
- **Expected Response**: 
  ```json
  {
    "audioUrl": "/audio/<filename>",
    "prompt": "Now, give it another try! Show me the sign for [color]."
  }
  ```
  - **audioUrl**: URL to the generated audio file.
  - **prompt**: Text version of the prompt.

### 6. User Successfully Signs the Color
If the user successfully performs the sign, the front end uploads the confirmation audio.

```sh
curl -X POST http://localhost:5001/transcribe-audio -F "file=@path/to/your/audio-file.mp3"
```
- **Expected Response**: 
  ```json
  {
    "transcribedText": "i did it"
  }
  ```
  - **transcribedText**: Text transcription of the user's audio response.

Send the transcription result to confirm the successful attempt:

```sh
curl -X POST http://localhost:5001/user-response -H "Content-Type: application/json" -d '{"response": "i did it"}'
```
- **Expected Response**: 
  ```json
  {
    "audioUrl": "/audio/<filename>",
    "prompt": "Well done! You signed [color] perfectly. Let's move on to the next color."
  }
  ```
  - **audioUrl**: URL to the generated audio file.
  - **prompt**: Text version of the prompt.

### 7. Serve Audio File
To serve an audio file generated by the AI, use the `/audio/<filename>` endpoint:

```sh
curl -X GET http://localhost:5001/audio/abcd1234.mp3 --output abcd1234.mp3
```
- Replace `abcd1234.mp3` with the actual filename provided in the responses.
- The downloaded audio can then be played for the user.

## Summary of Flow
1. **Initial Prompt**: Use `/start` to begin the interaction.
2. **User Response (Voice)**: Record and send user's response to `/transcribe-audio` for conversion to text.
3. **Process User Response**: Send the transcribed response to `/user-response`.
4. **Request Help**: If needed, ask for help using `/help`.
5. **Retry**: Encourage the user to retry the sign using `/retry`.
6. **Successful Completion**: Confirm successful signing and proceed to the next color.
7. **Download and Play Audio**: Use `/audio/<filename>` to serve and play generated audio files.

## Notes
- Each interaction is voice-based, with transcriptions converted to text using the `/transcribe-audio` endpoint.
- The process continues for each color in the set, with users moving to new colors after successful attempts or retries.

This flow ensures an engaging and interactive learning experience for practicing Makaton signs for colors.